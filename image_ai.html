<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>AI Temporary Image Viewer</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; }
    h1 { margin-bottom: 0.5rem; }
    .muted { color: #666; margin-bottom: 1rem; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 20px; }
    #img { display: none; margin-top: 1rem; max-width: 100%; border-radius: 8px; }
    #placeholder { margin-top: 1rem; color: #aaa; }
    #result { margin-top: 1rem; font-weight: bold; }
  </style>
</head>
<body>
  <h1>AI Temporary Image Viewer</h1>
  <div class="muted">Upload an image → AI will try to recognize it. Nothing is saved. Refresh clears everything.</div>

  <div class="card">
    <input id="file" type="file" accept="image/*"/>
    <img id="img" alt="Uploaded preview"/>
    <div id="placeholder">No image uploaded yet.</div>
    <div id="result"></div>
  </div>

  <!-- TensorFlow.js + MobileNet -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>

  <script>
    const fileInput = document.getElementById('file');
    const img = document.getElementById('img');
    const placeholder = document.getElementById('placeholder');
    const resultBox = document.getElementById('result');
    let model = null;

    async function loadModel() {
      if (!model) {
        resultBox.textContent = "Loading AI model…";
        model = await mobilenet.load();
        resultBox.textContent = "";
      }
    }

    fileInput.addEventListener('change', async () => {
      const file = fileInput.files[0];
      if (!file) return;

      await loadModel();

      const url = URL.createObjectURL(file);
      img.src = url;
      img.style.display = 'block';
      placeholder.style.display = 'none';
      resultBox.textContent = "Analyzing…";

      img.onload = async () => {
        const predictions = await model.classify(img);
        if (predictions.length > 0) {
          const top = predictions[0];
          resultBox.textContent = `AI says: ${top.className} (confidence: ${(top.probability*100).toFixed(1)}%)`;
        } else {
          resultBox.textContent = "AI couldn't recognize this image.";
        }
      };
    });
  </script>
</body>
</html>
